"use strict";(self.webpackChunkharvester_docs=self.webpackChunkharvester_docs||[]).push([[1488],{3905:(e,t,r)=>{r.d(t,{Zo:()=>l,kt:()=>h});var a=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var p=a.createContext({}),u=function(e){var t=a.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},l=function(e){var t=u(e.components);return a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,p=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),m=u(r),h=n,c=m["".concat(p,".").concat(h)]||m[h]||d[h]||o;return r?a.createElement(c,i(i({ref:t},l),{},{components:r})):a.createElement(c,i({ref:t},l))}));function h(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=m;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var u=2;u<o;u++)i[u]=r[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}m.displayName="MDXCreateElement"},88033:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>u});var a=r(87462),n=(r(67294),r(3905));const o={sidebar_position:2,sidebar_label:"Upgrade from v1.0.3 to v1.1.0",title:""},i="Upgrade from v1.0.3 to v1.1.0",s={unversionedId:"upgrade/v1-0-3-to-v1-1-0",id:"upgrade/v1-0-3-to-v1-1-0",title:"",description:"Please do not upgrade a running cluster to v1.1.0 if the cluster has the following configuration:",source:"@site/docs/upgrade/v1-0-3-to-v1-1-0.md",sourceDirName:"upgrade",slug:"/upgrade/v1-0-3-to-v1-1-0",permalink:"/zh/v1.1/upgrade/v1-0-3-to-v1-1-0",draft:!1,editUrl:"https://github.com/harvester/docs/edit/main/docs/upgrade/v1-0-3-to-v1-1-0.md",tags:[],version:"current",lastUpdatedAt:1666851656,formattedLastUpdatedAt:"2022\u5e7410\u670827\u65e5",sidebarPosition:2,frontMatter:{sidebar_position:2,sidebar_label:"Upgrade from v1.0.3 to v1.1.0",title:""},sidebar:"tutorialSidebar",previous:{title:"Upgrading Harvester",permalink:"/zh/v1.1/upgrade/automatic"},next:{title:"Troubleshooting",permalink:"/zh/v1.1/upgrade/troubleshooting"}},p={},u=[{value:"General information",id:"general-information",level:2},{value:"Known issues",id:"known-issues",level:2},{value:"1. An upgrade is stuck when pre-draining a node",id:"1-an-upgrade-is-stuck-when-pre-draining-a-node",level:3},{value:"2. An upgrade is stuck after a node is pre-drained",id:"2-an-upgrade-is-stuck-after-a-node-is-pre-drained",level:3},{value:"3. The monitor dashboard displays nothing after an upgrade",id:"3-the-monitor-dashboard-displays-nothing-after-an-upgrade",level:3}],l={toc:u};function d(e){let{components:t,...o}=e;return(0,n.kt)("wrapper",(0,a.Z)({},l,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"upgrade-from-v103-to-v110"},"Upgrade from v1.0.3 to v1.1.0"),(0,n.kt)("admonition",{type:"danger"},(0,n.kt)("p",{parentName:"admonition"},"Please do not upgrade a running cluster to v1.1.0 if the cluster has the following configuration:"),(0,n.kt)("ul",{parentName:"admonition"},(0,n.kt)("li",{parentName:"ul"},"The harvester-mgmt network contains two or more network interfaces.")),(0,n.kt)("pre",{parentName:"admonition"},(0,n.kt)("code",{parentName:"pre"},"  networks:\n    harvester-mgmt:\n      interfaces:\n      - name: ens5\n      - name: ens6\n      method: dhcp\n")),(0,n.kt)("ul",{parentName:"admonition"},(0,n.kt)("li",{parentName:"ul"},"Defining a cluster_network in the configuration file with harvester-mgmt network:")),(0,n.kt)("pre",{parentName:"admonition"},(0,n.kt)("code",{parentName:"pre"},'cluster_networks:\n  vlan:\n    enable: true\n    description: "harvester-mgmt"\n    config:\n      defaultPhysicalNIC: harvester-mgmt\n')),(0,n.kt)("p",{parentName:"admonition"},"Related issue: ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/harvester/harvester/issues/3045"},"[BUG] Harvester Upgrade 1.0.3 to 1.1.0 does not handle multiple SLAVE in BOND for management interface"))),(0,n.kt)("h2",{id:"general-information"},"General information"),(0,n.kt)("admonition",{type:"caution"},(0,n.kt)("ul",{parentName:"admonition"},(0,n.kt)("li",{parentName:"ul"},"Starting from version v1.1.0, Harvester brings in the new ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/harvester/harvester/issues/2236"},"VLAN enhancement")," feature. Due to the implementation changes, all user VMs must shut down during an upgrade. Please stop the VMs before an upgrade."))),(0,n.kt)("p",null,"Once there is an upgradable version, the Harvester GUI Dashboard page will show an upgrade button. For more details, please refer to ",(0,n.kt)("a",{parentName:"p",href:"/zh/v1.1/upgrade/automatic#start-an-upgrade"},"start an upgrade"),"."),(0,n.kt)("p",null,"For the air-gap env upgrade, please refer to ",(0,n.kt)("a",{parentName:"p",href:"/zh/v1.1/upgrade/automatic#prepare-an-air-gapped-upgrade"},"prepare an air-gapped upgrade"),"."),(0,n.kt)("h2",{id:"known-issues"},"Known issues"),(0,n.kt)("hr",null),(0,n.kt)("h3",{id:"1-an-upgrade-is-stuck-when-pre-draining-a-node"},"1. An upgrade is stuck when pre-draining a node"),(0,n.kt)("p",null,'Starting from v1.1.0, Harvester will wait for all volumes to become healthy (when node counts >= 3) before upgrading a node. Generally, users can check volumes\' health if an upgrade is stuck in the "pre-draining" state.'),(0,n.kt)("p",null,"Visit ",(0,n.kt)("a",{parentName:"p",href:"/zh/v1.1/troubleshooting/harvester#access-embedded-longhorn"},'"Access Embedded Longhorn"')," to see how to access the embedded Longhorn GUI."),(0,n.kt)("hr",null),(0,n.kt)("h3",{id:"2-an-upgrade-is-stuck-after-a-node-is-pre-drained"},"2. An upgrade is stuck after a node is pre-drained"),(0,n.kt)("p",null,"An upgrade is stuck, as shown in the screenshot below:"),(0,n.kt)("p",null,(0,n.kt)("img",{src:r(25204).Z,width:"1136",height:"504"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Related issue:",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/harvester/harvester/issues/3021"},"[BUG] Upgrade stop at upgrading node3 stage, stuck in Pre-drained status")))),(0,n.kt)("li",{parentName:"ul"},"Workaround:",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/harvester/harvester/issues/3021#issuecomment-1288747614"},"https://github.com/harvester/harvester/issues/3021#issuecomment-1288747614"))))),(0,n.kt)("hr",null),(0,n.kt)("h3",{id:"3-the-monitor-dashboard-displays-nothing-after-an-upgrade"},"3. The monitor dashboard displays nothing after an upgrade"),(0,n.kt)("p",null,"After an upgrade, the user might see the embedded Grafana dashboard doesn't work:"),(0,n.kt)("p",null,(0,n.kt)("img",{src:r(62301).Z,width:"3284",height:"588"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Related issue:",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/harvester/harvester/issues/2984"},"[BUG] Cant's display monitoring dashboard after upgrade, alertmanager, prometheus and grafana monitoring pods Terminating")))),(0,n.kt)("li",{parentName:"ul"},"Workaround:",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/harvester/harvester/issues/2984#issuecomment-1286517922"},"https://github.com/harvester/harvester/issues/2984#issuecomment-1286517922"))))))}d.isMDXComponent=!0},62301:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/2984-grafana-b85f039074c1b3f8ec47b93f1194573a.png"},25204:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/3021-stuck-fe36d9af55b75fc0818de41c48ec670b.png"}}]);